# Имитационная модель розничного магазина

## Описание проекта

Данный проект представляет собой имитационную модель работы розничного магазина, позволяющую анализировать влияние различных параметров на эффективность обслуживания покупателей. Модель реализована с использованием дискретно-событийного моделирования и предоставляет графический интерфейс для настройки параметров, проведения экспериментов и анализа результатов.

## Структура проекта

Проект состоит из следующих модулей:

- `main.py` — основной модуль для запуска приложения
- `gui.py` — графический интерфейс пользователя
- `simulation.py` — реализация имитационной модели
- `visualization.py` — модуль для визуализации результатов моделирования

## Принцип работы имитационной модели

### Теоретическая основа

Имитационная модель построена на основе **дискретно-событийного моделирования** с использованием библиотеки SimPy. Этот подход позволяет симулировать последовательность дискретных событий, происходящих в определенные моменты времени, и отслеживать изменение состояния системы.

### Ключевые элементы модели

#### 1. Генерация покупателей

- Покупатели прибывают в магазин с **интервалами, распределенными по экспоненциальному закону** со средним значением, задаваемым через параметр `customer_arrival_mean`.
- Экспоненциальное распределение выбрано потому, что оно хорошо моделирует случайные события, происходящие независимо друг от друга с постоянной средней частотой.

#### 2. Процесс выбора товаров

- Время, затрачиваемое покупателем на выбор товаров, может быть смоделировано с использованием одного из трех распределений:
  - **Нормальное распределение** — соответствует ситуации, когда большинство покупателей тратит на выбор товаров время, близкое к среднему значению
  - **Равномерное распределение** — соответствует ситуации, когда время выбора товаров равновероятно в заданном диапазоне
  - **Экспоненциальное распределение** — соответствует ситуации, когда большинство покупателей тратит на выбор товаров относительно небольшое время, но некоторые могут задержаться значительно дольше

#### 3. Обслуживание на кассах

- Магазин имеет фиксированное количество касс, каждая из которых может обслуживать одного покупателя одновременно.
- Время обслуживания на кассе может быть смоделировано с использованием:
  - **Нормального распределения** — для случаев, когда время обслуживания примерно одинаково для всех покупателей
  - **Экспоненциального распределения** — для случаев, когда время обслуживания сильно варьируется

#### 4. Очереди к кассам

- Если все кассы заняты, покупатели формируют общую очередь.
- Реализована стратегия обслуживания FIFO (First In, First Out) — первым обслуживается покупатель, первым вставший в очередь.

### Технические детали реализации

#### Класс ShopSimulation (simulation.py)

Основной класс, реализующий имитационную модель магазина. Включает следующие ключевые методы:

1. ****init**(params)** — инициализация модели с заданными параметрами:

   - `seed` — зерно генератора случайных чисел для обеспечения воспроизводимости
   - `simulation_time` — время симуляции в минутах
   - `customer_arrival_mean` — среднее время между прибытиями покупателей
   - Параметры времени выбора товаров (распределение, среднее, стандартное отклонение и т.д.)
   - Параметры обслуживания на кассе
   - Количество касс

2. **generate_shopping_time()** — генерирует время выбора товаров в соответствии с выбранным распределением.

3. **generate_service_time()** — генерирует время обслуживания на кассе.

4. **customer_process(customer_id)** — процесс, моделирующий поведение отдельного покупателя:

   - Прибытие в магазин
   - Выбор товаров
   - Ожидание в очереди
   - Обслуживание на кассе
   - Уход из магазина

5. **customer_generator()** — процесс, генерирующий поток покупателей.

6. **monitor_queue()** — процесс, отслеживающий изменение длины очереди во времени.

7. **run_simulation()** — запуск симуляции на заданное время.

8. **calculate_results()** — расчет итоговых статистик по результатам симуляции.

#### Процесс симуляции

1. Инициализируется среда моделирования SimPy (`simpy.Environment`).
2. Создаются ресурсы (кассы) с заданной емкостью.
3. Запускается процесс генерации покупателей.
4. Запускается процесс мониторинга длины очереди.
5. Среда моделирования запускается на заданное время.
6. По окончании симуляции рассчитываются итоговые статистики.

#### Сбор статистики

В процессе симуляции собирается следующая статистика:

- Количество прибывших и обслуженных покупателей
- Время нахождения покупателей в магазине
- Время ожидания в очереди
- Длина очереди в разные моменты времени
- Интервалы занятости касс

#### Результаты симуляции

По окончании симуляции рассчитываются следующие показатели:

- Общее количество прибывших и обслуженных покупателей
- Среднее и максимальное время нахождения в магазине
- Среднее и максимальное время ожидания в очереди
- Средняя и максимальная длина очереди
- Коэффициент загрузки кассовых узлов

## Графический интерфейс (gui.py)

Графический интерфейс состоит из трех вкладок:

### 1. Вкладка "Симуляция"

Позволяет настроить параметры модели и запустить одиночную симуляцию:

- Время симуляции
- Параметры прибытия покупателей
- Параметры выбора товаров
- Параметры обслуживания на кассах
- Количество касс

### 2. Вкладка "Эксперимент"

Предназначена для проведения серии экспериментов с изменением одного параметра:

- Выбор изменяемого параметра
- Настройка диапазона значений и шага изменения
- Выбор анализируемой метрики

### 3. Вкладка "Результаты"

Отображает результаты симуляции:

- Текстовая информация об основных показателях
- Графики:
  - Сводная панель со всеми ключевыми метриками
  - График изменения длины очереди во времени
  - Гистограмма времени ожидания
  - Гистограмма времени нахождения в магазине
  - Диаграмма загрузки касс

## Визуализация результатов (visualization.py)

Модуль `visualization.py` содержит класс `SimulationVisualizer`, предоставляющий методы для построения различных графиков на основе результатов симуляции:

1. **plot_queue_length_over_time()** — график изменения длины очереди во времени
2. **plot_waiting_time_histogram()** — гистограмма времени ожидания в очереди
3. **plot_time_in_shop_histogram()** — гистограмма времени нахождения в магазине
4. **plot_cash_desk_utilization()** — диаграмма коэффициентов загрузки касс
5. **plot_comparative_experiment()** — график зависимости выбранной метрики от изменяемого параметра
6. **create_summary_dashboard()** — сводная панель с ключевыми графиками

## Проведение экспериментов

Проект позволяет проводить серию экспериментов с изменением одного параметра и анализировать влияние этого изменения на выбранную метрику. Доступны следующие параметры для экспериментов:

- Количество касс
- Интервал прибытия покупателей
- Среднее время выбора товаров
- Среднее время обслуживания

Для каждого значения параметра проводится отдельная симуляция, и результаты отображаются на графике зависимости выбранной метрики от значения параметра.

## Аналитические выводы

На основе результатов симуляции и экспериментов проект автоматически генерирует аналитические выводы:

- Оценка эффективности работы касс
- Рекомендации по оптимизации количества касс
- Анализ времени ожидания покупателей
- Оценка качества обслуживания

## Запуск программы

Для запуска программы необходимо выполнить файл `main.py`:

```
python main.py
```

## Требования

- Python 3.6 или выше
- SimPy
- NumPy
- Matplotlib
- Seaborn
- Tkinter

## Пример использования

1. Запустите программу.
2. На вкладке "Симуляция" настройте параметры модели:
   - Установите время симуляции (например, 480 минут — 8 часов работы магазина)
   - Настройте интервал прибытия покупателей
   - Выберите распределение времени выбора товаров и настройте его параметры
   - Установите количество касс
   - Настройте параметры обслуживания на кассах
3. Нажмите кнопку "Запустить симуляцию".
4. После завершения симуляции перейдите на вкладку "Результаты" для анализа показателей.
5. Для проведения эксперимента перейдите на вкладку "Эксперимент":
   - Выберите параметр для изменения (например, "Количество касс")
   - Установите диапазон значений и шаг
   - Выберите анализируемую метрику (например, "Среднее время ожидания")
   - Нажмите кнопку "Запустить эксперимент"
6. Проанализируйте результаты эксперимента и сгенерированные выводы.
